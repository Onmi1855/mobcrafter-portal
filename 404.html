<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MobCrafter Portal</title>
</head>
<body>
<script>
(() => {
  // GitHub Pages 404 を SPA ルーターとして使う
  // /u/<no> や /u/<uuid> → /u/index.html?p=/u/<...> に転送
  // ループ防止を最優先

  const path = location.pathname || "/";
  const search = location.search || "";
  const hash = location.hash || "";

  // ここに居るなら絶対何もしない（ループ防止）
  if (path === "/u/index.html") return;

  // /u だけは不正扱い（トップへ）
  if (path === "/u" || path === "/u/") {
    location.replace("/");
    return;
  }

  // /u/<something> は全部拾う（数字でもUUIDでもOK）
  const m = path.match(/^\/u\/([^\/?#]+)$/);
  if (m) {
    const p = encodeURIComponent(path + search + hash);
    location.replace("/u/index.html?p=" + p);
    return;
  }

  // その他はトップへ
  location.replace("/");
})();
</script>
</body>
</html>
